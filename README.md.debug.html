<h1><a id="user-content-table-of-contents" class="anchor" aria-hidden="true" href="#table-of-contents"><span aria-hidden="true" class="octicon octicon-link"></span></a>Table of Contents</h1>
<p>Header: Strict-Transport-Security=max-age=31536000; includeSubdomains; preload
Header: X-Xss-Protection=0
Header: Vary=Accept
Header: X-Ratelimit-Reset=1664958091
Header: X-Ratelimit-Resource=core
Header: Etag=W/"7e846b8981055c5bb19271218edeb297b78cb1e08b2e589dad735bb059ec2533"
Header: X-Github-Media-Type=github.v3; format=json
Header: X-Ratelimit-Remaining=43
Header: X-Ratelimit-Used=17
Header: Access-Control-Allow-Origin=*
Header: Date=Wed, 05 Oct 2022 07:56:35 GMT
Header: Content-Type=text/html;charset=utf-8
Header: Cache-Control=public, max-age=60, s-maxage=60
Header: X-Github-Request-Id=E222:0C92:11B83C7:1283BAF:633D38B3
Header: X-Content-Type-Options=nosniff
Header: Referrer-Policy=origin-when-cross-origin, strict-origin-when-cross-origin
Header: Content-Security-Policy=default-src 'none'
Header: Server=GitHub.com
Header: Access-Control-Expose-Headers=ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateL
imit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, X-GitHub-SSO, X-GitHub-Request-Id, Deprec
ation, Sunset
Header: X-Commonmarker-Version=0.23.6
Header: X-Ratelimit-Limit=60
Header: X-Frame-Options=deny</p>
<h1><a id="user-content-wiki原始语料获取" class="anchor" aria-hidden="true" href="#wiki原始语料获取"><span aria-hidden="true" class="octicon octicon-link"></span></a>Wiki原始语料获取</h1>
<p>wiki数据源自wikidump</p>
<p><a href="https://dumps.wikimedia.org/zhwiki/latest/" rel="nofollow">Wikidump下载链接</a></p>
<p>进入网页后选取<code>zhwiki-20220801-pages-articles-multistream.xml.bz2</code></p>
<h1><a id="user-content-数据分析与处理" class="anchor" aria-hidden="true" href="#数据分析与处理"><span aria-hidden="true" class="octicon octicon-link"></span></a>数据分析与处理</h1>
<h2><a id="user-content-wikidumpxml数据格式分析" class="anchor" aria-hidden="true" href="#wikidumpxml数据格式分析"><span aria-hidden="true" class="octicon octicon-link"></span></a>Wikidump<code>xml</code>数据格式分析：</h2>
<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">mediawiki</span> <span class="pl-e">xmlns</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.mediawiki.org/xml/export-0.10/<span class="pl-pds">"</span></span> <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">xsi</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="pl-pds">"</span></span> <span class="pl-e">xsi</span><span class="pl-e">:</span><span class="pl-e">schemaLocation</span>=<span class="pl-s"><span class="pl-pds">"</span>http://www.mediawiki.org/xml/export-0.10/ http://www.mediawiki.org/xml/export-0.10.xsd<span class="pl-pds">"</span></span> <span class="pl-e">version</span>=<span class="pl-s"><span class="pl-pds">"</span>0.10<span class="pl-pds">"</span></span> <span class="pl-e">xml</span><span class="pl-e">:</span><span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>zh<span class="pl-pds">"</span></span>&gt;
    <span class="pl-c"><span class="pl-c">&lt;!--</span>一个page表示一个网页，数据由1294978个page组成<span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">page</span>&gt;
        &lt;<span class="pl-ent">title</span>&gt;<span class="pl-c"><span class="pl-c">&lt;!--</span>网页标题，可用作实体名称<span class="pl-c">--&gt;</span></span>&lt;/<span class="pl-ent">title</span>&gt;
        &lt;<span class="pl-ent">id</span>&gt;<span class="pl-c"><span class="pl-c">&lt;!--</span>网页唯一ID，用数字表示<span class="pl-c">--&gt;</span></span>&lt;/<span class="pl-ent">id</span>&gt;
        &lt;<span class="pl-ent">parentid</span>&gt;57201542&lt;/<span class="pl-ent">parentid</span>&gt;
        &lt;<span class="pl-ent">timestamp</span>&gt;2020-01-24T01:31:16Z&lt;/<span class="pl-ent">timestamp</span>&gt;
        &lt;<span class="pl-ent">model</span>&gt;wikitext&lt;/<span class="pl-ent">model</span>&gt;
        &lt;<span class="pl-ent">contributor</span>&gt;
        &lt;<span class="pl-ent">username</span>&gt;InternetArchiveBot&lt;/<span class="pl-ent">username</span>&gt;
        &lt;<span class="pl-ent">comment</span>&gt;<span class="pl-c"><span class="pl-c">&lt;!--</span>网页曾经新的修改信息<span class="pl-c">--&gt;</span></span>&lt;/<span class="pl-ent">comment</span>&gt;
        &lt;<span class="pl-ent">format</span>&gt;text/x-wiki&lt;/<span class="pl-ent">format</span>&gt;
        &lt;<span class="pl-ent">id</span>&gt;2383178&lt;/<span class="pl-ent">id</span>&gt;
      	&lt;/<span class="pl-ent">contributor</span>&gt;
        &lt;<span class="pl-ent">text</span> <span class="pl-e">bytes</span>=<span class="pl-s"><span class="pl-pds">"</span>网页大小<span class="pl-pds">"</span></span> <span class="pl-e">xml</span><span class="pl-e">:</span><span class="pl-e">space</span>=<span class="pl-s"><span class="pl-pds">"</span>preserve<span class="pl-pds">"</span></span>&gt;
            <span class="pl-c"><span class="pl-c">&lt;!--</span>网页内容<span class="pl-c">--&gt;</span></span>
        &lt;/<span class="pl-ent">text</span>&gt;
    &lt;/<span class="pl-ent">page</span>&gt;
&lt;/<span class="pl-ent">mediawiki</span>&gt;</pre></div>
<p>原始数据大小2.7个G，解压后有11个G，共有1294948个页面</p>
<h2><a id="user-content-网页内容text标签内容格式分析" class="anchor" aria-hidden="true" href="#网页内容text标签内容格式分析"><span aria-hidden="true" class="octicon octicon-link"></span></a>网页内容（<code>&lt;text&gt;</code>标签内容）格式分析</h2>
<p>经过分析，网页可分为4个部分</p>
<table>
<thead>
<tr>
<th align="center">网页部分</th>
<th align="center">描述</th>
<th align="center">识别标志</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Infobox</td>
<td align="center">网页实体的属性表，贴在网页的</td>
<td align="center">以<code>{{}}</code>为标志，在网页的开头，可能没有</td>
</tr>
<tr>
<td align="center">summary</td>
<td align="center">网页实体的简介</td>
<td align="center">在infobox和para之间，的一个简短文本</td>
</tr>
<tr>
<td align="center">para</td>
<td align="center">实体各个方面的详细介绍</td>
<td align="center">以<code>==xx==</code>为标志，遇到的第一个就是para的开始</td>
</tr>
<tr>
<td align="center">category</td>
<td align="center">实体属于的类别链接</td>
<td align="center">以<code>[[Category:xx]]</code>为标志，在网页的末尾</td>
</tr>
</tbody>
</table>
<p>以一个网页为例子</p>
<div class="highlight highlight-text-xml"><pre>{{Automatic taxobox
| taxon = Pseudomugilidae
| image = 
| image_caption = 
| authority = 
| subdivision_ranks = [[屬]]
| subdivision =
見內文
}}

'''似鯔銀漢魚科'''為[[輻鰭魚綱]][[銀漢魚目]]的其中一[[科]]。

==分布==
本鱼广泛澳洲东部之溪流域，最南可达到雪梨。

==特征==
本鱼体适度延长，侧扁；嘴小，略垂直；前主上腭之后部齿较长，于口闭合时会外露；第一背鳍起点在胸鳍末端以前，具3至6棘；第二背鳍具1棘棘6至10枚软条；臀鳍之起点在第一背鳍末端之下方，具1棘及9至12枚软条；胸鳍尖形，尾鳍开叉；无侧线，一纵列鳞具25至31枚。雌雄异形，雄鱼背鳍、臀鳍及腹鳍之前方各鳍条成丝状延长；在春夏之繁殖季节，体色会变成鲜艳之黄色。雄鱼体长可达7公分。

[[Category:鯔銀漢魚科|*]]
[[Category:银汉鱼目|Z]]</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/ReturnTR/PensonKG/blob/main/images/wiki_%E6%95%B0%E6%8D%AE%E5%AE%9E%E4%BE%8B.png"><img src="https://github.com/ReturnTR/PensonKG/raw/main/images/wiki_%E6%95%B0%E6%8D%AE%E5%AE%9E%E4%BE%8B.png" alt="image" style="max-width: 100%;"></a></p>
<h2><a id="user-content-初步格式化抽取出上面提到的的4项" class="anchor" aria-hidden="true" href="#初步格式化抽取出上面提到的的4项"><span aria-hidden="true" class="octicon octicon-link"></span></a>初步格式化(抽取出上面提到的的4项)</h2>
<p>根据前面分析的四项，通过特定的规则将他们抽取出来，同时尽量保留原有信息</p>
<ul>
<li>简介和正文繁体转简体</li>
<li>在正文和简介中，除了[[]]标签和[]标签，去掉所有的其他标签，只保留文字与标点符号</li>
<li>保留infobox与category的全部内容</li>
</ul>
<p><a href="https://github.com/ReturnTR/PensonKG/blob/main/code/WikiProcess.py">抽取代码</a></p>
<h2><a id="user-content-抽取出有infobox的人物页面" class="anchor" aria-hidden="true" href="#抽取出有infobox的人物页面"><span aria-hidden="true" class="octicon octicon-link"></span></a>抽取出有infobox的人物页面</h2>
<p>目标是人物图谱，所以需要将人物页面截取过来，由于判断是否是人物的方法很复杂，因此先通过infobox里面的标识识别出部分的人物</p>
<p>为此需要先找到全部的infobox人物模板标识，Wiki提供了人物 infobox 的标识，见<a href="https://zh.wikipedia.org/wiki/Category:%E4%BA%BA%E7%89%A9%E4%BF%A1%E6%81%AF%E6%A1%86%E6%A8%A1%E6%9D%BF" rel="nofollow">分类:人物信息框模板 - 维基百科，自由的百科全书 (wikipedia.org)</a>（在wiki中infobox被称为信息框）</p>
<p>例如</p>
<div class="highlight highlight-text-xml"><pre>{{Infobox NBA Player
| name = 姚明&lt;<span class="pl-ent">br</span>/&gt;Yao Ming
| image = YaoMingonoffense2.jpg
| height_ft   = 7
| height_in   = 5
| weight_lb   = 310
| nationality = {{PRC}}
| birth_date = {{Birth date and age|1980|9|12}}
| birth_place = {{CHN}}[[上海市]][[徐匯區]]
...
}}</pre></div>
<p>其中<code>Infobox NBA Player</code>为infobox的开头，表示页面的类型，而该类型出来在上述的人物信息框模板中，因此该页面被认为是人物的页面</p>
<p>为此，我们需要将该网页下所有的模板记录在案，然后对每一个页面的infobox开头进行匹配，匹配成功则将其归类到人物页面中</p>
<p><a href="https://github.com/ReturnTR/PensonKG/blob/main/code/GetPersonViaInfobox.py">抽取代码</a></p>
<h2><a id="user-content-对人物infobox进行属性抽取" class="anchor" aria-hidden="true" href="#对人物infobox进行属性抽取"><span aria-hidden="true" class="octicon octicon-link"></span></a>对人物Infobox进行属性抽取</h2>
<div class="highlight highlight-text-xml"><pre>{{Infobox NBA Player
| name = 姚明&lt;<span class="pl-ent">br</span>/&gt;Yao Ming
| image = YaoMingonoffense2.jpg
| height_ft   = 7
| height_in   = 5
| weight_lb   = 310
| nationality = {{PRC}}
| birth_date = {{Birth date and age|1980|9|12}}
| birth_place = {{CHN}}[[上海市]][[徐匯區]]
| high_school = 
| college = [[上海交通大学安泰经济与管理学院]]&lt;ref&gt;{{cite web | language = zh-hans | publisher = 网易网&gt; 教育频道&gt;正文 | title = 姚明正式就读上海交通大学经济类本科(组图) | url = http://edu.163.com/11/1107/22/7I9RATJI00293L7F.html | author = 本文来源：新华网；责任编辑：王晓易 | date = 2011年11月7日 | accessdate = 2011年11月7日 | archive-date = 2017年8月7日 | archive-url = https://web.archive.org/web/20170807152231/http://edu.163.com/11/1107/22/7I9RATJI00293L7F.html | dead-url = no }}&lt;/ref&gt;&lt;!-- [[香港大学]]荣誉社会科学博士&lt;ref&gt;{{cite web | language = zh-hans | publisher = 网易网&gt;教育频道&gt;考研&gt;最新资讯&gt;正文 | title = 姚明获颁港大名誉博士学位 梁振英亲自颁授 | url = http://edu.163.com/12/1128/13/8HDCIQSL00293NU2.html | author = 本文来源：中国新闻网；责任编辑：王晓易 | date = 2012年11月28日 | accessdate = 2012年11月28日 | archive-url = https://web.archive.org/web/20121130141208/http://edu.163.com/12/1128/13/8HDCIQSL00293NU2.html | archive-date = 2012年11月30日 | dead-url = yes }}&lt;/ref&gt;  --&gt;
| position    = 第六任主席
| draft_round = 1
| draft_pick = 1
| draft_team = [[休士頓火箭]]
| draft_year = 2002
| career_position = [[中鋒 (籃球)|中鋒]]
| career_start    = 1997年
| career_end      = 2011年
| career_number   = 11
| years1          = 1997－2002
| team1           = [[上海大鯊魚籃球俱樂部|上海大鯊魚]] 
| years2          = {{nbay|2002|start}}－{{nbay|2010|end}}
| team2           = [[休士頓火箭]]
| awards =
&lt;<span class="pl-ent">div</span>&gt;
* 8×[[NBA全明星賽]]（2003－2009、2011）
* 2×[[NBA最佳陣容|NBA年度第二隊]]（2007、2009）
* 3×[[NBA最佳陣容|NBA年度第三隊]]（2004、2006、2008）
* [[NBA最佳新秀陣容|NBA最佳新秀陣容第一隊]](2003)
* 11号[[球衣]]为[[休士頓火箭]]所[[退役]]
* [[中國男子籃球職業聯賽|CBA總冠軍]]（2002）
* [[中国男子篮球职业联赛常规赛最有价值球员|CBA常规赛最有价值球员]]（2001）&lt;<span class="pl-ent">ref</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>联赛MVP<span class="pl-pds">"</span></span>&gt;{{Cite web|title=CBA历届冠亚军及总决赛MVP回顾：广东八一争霸_体育频道_凤凰网|url=http://sports.ifeng.com/lanqiu/special/2013cba-finals/content-4/detail_2013_03/21/23352673_0.shtml|work=sports.ifeng.com|accessdate=2019-02-12|archive-url=https://web.archive.org/web/20190213005531/http://sports.ifeng.com/lanqiu/special/2013cba-finals/content-4/detail_2013_03/21/23352673_0.shtml|archive-date=2019-02-13|dead-url=yes}}&lt;/<span class="pl-ent">ref</span>&gt;
* 3×[[中国男子篮球职业联赛篮板王|CBA篮板王]]（2000、2001、2002）
* 3×[[中国男子篮球职业联赛盖帽王|CBA盖帽王]]（2000、2001、2002）
* 2×[[中国男子篮球职业联赛扣篮王|CBA扣篮王]]（2000、2001）
* 15号球衣被上海大鲨鱼退役
* [[勞倫斯世界體育獎#年度最佳新人獎|勞倫斯世界體育獎-年度最佳新人]]（2003）
* [[ESPN]]全球最有潛力運動員（2000）
*[[上海市]]第十一屆[[全國政協委員]](2008)
*[[上海市]]第十一屆[[全國政協委員|全國政協委員會常務委員]](2008)
*[[上海市]]第十二屆[[全國政協委員]](2013-2017)
*[[上海市]]第十三屆[[全國政協委員]](2017－)
*[[劳伦斯世界体育奖#年度体育精神奖|劳伦斯世界体育奖-年度体育精神奖]]（2015）
* 3×[[亞洲盃籃球賽]]MVP（2001、2003、{{tsl|en|2005 FIBA Asia Championship|2005}}）
|stats_league = NBA
|stat1label = [[得分]]
|stat1value = 9,247（場均19.0分）
|stat2label = [[籃板]]
|stat2value = 4,494（場均9.2個）
|stat3label = [[助攻]]
|stat3value = 920（場均1.9次）
|letter = m
|bbr = mingya01
|HOF_player=yao-ming
|medaltemplates = 
{{MedalCountry|{{CHN-1949}}}}
{{MedalSport|男子篮球}}
{{MedalCompetition|亞洲青年籃球錦標賽}}
{{MedalGold|1998年印度西孟加拉邦加爾各答|}}
{{MedalCompetition|東亞運動會}}
{{MedalGold|2001年日本大阪府|}}
{{MedalCompetition|[[亚洲篮球锦标赛]]}}
{{MedalGold|{{tsl|en|2001 ABC Championship|2001年中國上海市}}|}}
{{MedalGold|{{tsl|en|2003 ABC Championship|2003年中國黑龍江省哈爾濱市}}|}}
{{MedalGold|{{tsl|en|2005 FIBA Asia Championship|2005年卡達杜哈}}|}}
{{MedalCompetition|夏季世界大學生運動會}}
{{MedalSilver|2001年中國北京市|}}
{{MedalCompetition|亞洲運動會}}
{{MedalSilver|[[2002年亞洲運動會|2002年韓國釜山廣域市]]|}}
}}</pre></div>
<p>我们需要抽取出人物的基本属性，为此我们需要确定属性的含义以及属性的抽取方法</p>
<p>步骤：</p>
<ol>
<li>
<p>将模板的属性表全部列出，形成一个大的，整体的模板，包括：</p>
</li>
<li>
<ol>
<li>对每个infobox模板拆分，这时一个属性的内容有：中文，英文，额外格式信息</li>
<li>将重复的放在一起，并计数，重复的包括英文和中文</li>
</ol>
<p>最后形成如下的结构：</p>
<div class="highlight highlight-source-python"><pre>{
    <span class="pl-s">"属性名称"</span>:{					<span class="pl-c"># 英文为属性名称比较好</span>
        <span class="pl-s">"trigger"</span>:(<span class="pl-s">"中文"</span>,<span class="pl-s">"英文"</span>),	<span class="pl-c"># 与该属性</span>
        <span class="pl-s">"count"</span>:<span class="pl-c1">0</span>,       			<span class="pl-c"># 在模板中出现的次数</span>
        <span class="pl-s">"explain"</span>:<span class="pl-s">""</span>				<span class="pl-c"># 对该属性的解释</span>
    }
}</pre></div>
</li>
<li>
<p>分析模板中的属性值，设计抽取规则</p>
</li>
</ol>
<p>模</p>
<p>模板（templete）抽取</p>
<p>由杂乱到有序</p>
